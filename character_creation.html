<!DOCTYPE html>
<html>
<body>

<noscript>Sorry, your browser does not support JavaScript!</noscript>
<script type="text/javascript">
  //Returns the points needed for the skill level given
  function getPDelta(I) {
    return Math.sign(I)*(Math.abs(I)+1)*Math.abs(I)*2.5; // 5/2=2.5
  }

  //Returns the total skill level based on points allocated and initial skill level
  function computeSkillLevel(P,I) { //P is points in skill, I is initial level of skill
    var PDelta = getPDelta(I);
    if(P+PDelta < 0) {
      return -Math.ceil(-0.5 + Math.sqrt(5 + 8*Math.abs(PDelta+P))/4.472135955); //2*sqrt(5)
    } else {
      return Math.floor((-0.5 + Math.sqrt(5 + 8*Math.abs(PDelta+P))/4.472135955)+ 0.00001);
    }
  }
  
  //Updates a stat on change of its inputs
  function updateStat(P, I, T, L) { //T is total, L is points left until next level
    var PN = parseInt(document.getElementById(P).value); //Points
    var IN = parseInt(document.getElementById(I).value); //Initial level
    var TE = document.getElementById(T); //Total skill (element for output)
    var LE = document.getElementById(L); //Points left for next level (element for output)
    var SkillLevel=computeSkillLevel(PN,IN);
    TE.innerHTML=SkillLevel; //Write total skill level
    
    //Write points left for next level
    //It is the ([the points needed for the next level]-[the points needed for this level])-
    //([current points]-([the points needed for this level] - [the points needed for the initial skill level]))
    LE.innerHTML=(getPDelta(SkillLevel+1)-getPDelta(SkillLevel))-(PN-(getPDelta(SkillLevel)-getPDelta(IN)));
  }
  
  //Notifies the user of any problem with their skill levels by changing a textbox in the end
  function writeInitialLevelStatProblems (S, D, E, C, I, W, F) {
    //Strength, Dexterity, Endurance, Charisma, Intelligence, Will, Fate
    //Problems detected with initial stat levels: <output id="StatProblems">None.</output></br>
    //for all arguments
  }
  
  //Notifies the user of any problem with their stat levels by changing a textbox in the end
  function writeInitialLevelSkillProblems (I, H, C, U, E, A, M, G) {
    //Intuition, Handiwork, Conventional, Unconventional, Exotic, Auxilliary, Medical, Gen.Knowledge
    
  }
  
  //Compute stat point total and mission total and write them in a text box in the end
  function writeStatPointProblems (S, D, E, C, I, W, F) {
    //Strength, Dexterity, Endurance, Charisma, Intelligence, Will, Fate
    //Point total: <output id="TotalStatPoints">0</output> (<output id="StatMissions">0</output> Mission(s))</br>
  }
  
  //Compute skill point total and mission total and write them in a text box in the end
  function writeSkillPointProblems (I, H, C, U, E, A, M, G) {
    //Intuition, Handiwork, Conventional, Unconventional, Exotic, Auxilliary, Medical, Gen.Knowledge
    
  }
</script>


<h1>Character creation test</h1>
<h2>Stats</h2>
<table border="1" oninput="writeInitialLevelStatProblems('StrI','DexI','EndI','CharI','IntelI','WillI','FateI');writeStatPointProblems('StrI','DexI','EndI','CharI','IntelI','WillI','FateI');">
  <tr>
    <td><strong>Name</strong></td>
    <td><strong>Points assigned</strong></td>
    <td><strong>Initial level</strong></td>
    <td><strong>Total level</strong></td>
    <td><strong>Left for next level</strong></td>
  </tr>
  <tr oninput="updateStat('StrP','StrI','StrT','StrL');">
      <td>Strength</td>
      <td><input type="number" id="StrP" value="0"></td>
      <td><input type="number" id="StrI" value="0"></td>
      <td><output id="StrT">0</output></td>
      <td><output id="StrL">5</output></td>
  </tr>
  <tr oninput="updateStat('DexP','DexI','DexT','DexL');">
      <td>Dexterity</td>
      <td><input type="number" id="DexP" value="0"></td>
      <td><input type="number" id="DexI" value="0"></td>
      <td><output id="DexT">0</output></td>
      <td><output id="DexL">5</output></td>
  </tr>
  <tr oninput="updateStat('EndP','EndI','EndT','EndL');">
      <td>Endurance</td>
      <td><input type="number" id="EndP" value="0"></td>
      <td><input type="number" id="EndI" value="0"></td>
      <td><output id="EndT">0</output></td>
      <td><output id="EndL">5</output></td>
  </tr>
  <tr oninput="updateStat('ChaP','ChaI','ChaT','ChaL');">
      <td>Charisma</td>
      <td><input type="number" id="ChaP" value="0"></td>
      <td><input type="number" id="ChaI" value="0"></td>
      <td><output id="ChaT">0</output></td>
      <td><output id="ChaL">5</output></td>
  </tr>
  <tr oninput="updateStat('IntelP,'IntelI','IntelT','IntelL');">
      <td>Intelligence</td>
      <td><input type="number" id="IntelP" value="0"></td>
      <td><input type="number" id="IntelI" value="0"></td>
      <td><output id="IntelT">0</output></td>
      <td><output id="IntelL">5</output></td>
  </tr>
  <tr oninput="updateStat('WillP','WillI','WillT','WillL');">
      <td>Willlpower</td>
      <td><input type="number" id="WillP" value="0"></td>
      <td><input type="number" id="WillI" value="0"></td>
      <td><output id="WillT">0</output></td>
      <td><output id="WillL">5</output></td>
  </tr>
  <tr oninput="updateStat('FateP','FateI','FateT','FateL');">
      <td>Fate</td>
      <td><input type="number" id="FateP" value="0"></td>
      <td><input type="number" id="FateI" value="0"></td>
      <td><output id="FateT">0</output></td>
      <td><output id="FateL">5</output></td>
  </tr>
</table>

</br>
<p>
  Problems detected with initial stat levels: <output id="StatProblems">None.</output></br>
  Point total: <output id="TotalStatPoints">0</output> (<output id="StatMissions">0</output> Mission(s))</br>
</p>

<h2>Skills</h2>

</body>
</html>

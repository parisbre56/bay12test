<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    
  	<meta name="description" content="A page used to create new characters for Einsteinian Roulette.">
  	<meta name="keywords" content="Einsteinian Roulette, New Character, Character Calculator">
  	<meta name="author" content="Parisbre56">
  	
  	<title>ER New Character Creator</title>
  	
  	<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
  	<link rel="icon" type="image/x-icon" href="/favicon.ico"/>
  	
  	<link rel="stylesheet" type="text/css" href="/standardERStyle.css">
  	<style>
  		/*Style for making the form table-like*/
  		.formgroup {/*Fieldset is like a table*/
  			display: table;
  			width: 100%;
  		}
  		.formline {/*Formline is like a table row*/
  			display: table-row;
  			width: 100%;
  		}
  		.formlabel {
  			display: table-cell;
  			width: 20ch;
  			vertical-align: top;
  			text-align: right;
  		}
  		.formtext {
  			display: table-cell;
  		}
  		textarea,input[type=text] {
  			width: 100%;
  		}
  	</style>
  </head>
  
  
  <body id="body" class="whiteStyle">
    <noscript><p class="error">Sorry, your browser does not support JavaScript!</p></noscript>
    <script src="/ERScripts.js"></script> 
    <script type="text/javascript">
      "use strict";
      
      //Stats, skills, statted skills, statted skills with spam, spam skills statted skills with spam, spam spam spam spam...
      var stats = ['Str','Dex','End','Cha','Mind','Fate','Intu'];
      var skills = ['Hand','Con','Uncon','Exo','Aux','Med','Gen'];
      var sns = stats.concat(skills);
      
      //The length a reason assigned to HMRC should be before it is 
      //removed from the infobox and put in the personal info section.
      var reasonLength = 30;
      
      //Main function. Does everything
      function processInput() {
      	//First, initialise the outputs
      	//Error Element starts empty
      	var errorElement = document.getElementById("formErrors");
      	while (errorElement.firstChild) {
		errorElement.removeChild(errorElement.firstChild);
	}
      	//Start by opening a spoiler for the forum
      	var forumOutString = "[spoiler=";
      	//Start by opening a PC template for the wiki
      	var wikiOutString = "{{PC\n";
      	
      	//Start by checking if there is a username and a player name
      	//Get the two names
      	var username = document.getElementById("username").value;
      	var charname = document.getElementById("charname").value; 
      	//If character name is not empty (/S is regex for non-whitespace character)
      	if(/\S/.test(charname)) {
      		//Write it in the forum output
      		forumOutString+=charname;
      		//Write it in the wiki output
      		wikiOutString+="|name="+charname+"\n";
      	} else { //If no player name was provided
      		//Write an error in the forum output
      		forumOutString+="ERROR: Character name missing";
      		//Write an error in the wiki output
      		wikiOutString+="|name=ERROR: Character name missing\n";
      		//Write an error in the error element
      		writeTextAndBr(errorElement,"ERROR: Character name missing!");
      	}
      	//If user name is not empty
      	if(/\S/.test(username)) {
      		//Write it in the wiki output
      		wikiOutString+="|user="+username+"\n";
      	} else {//If no user name was provided
      		//Write an error in the wiki output
      		wikiOutString+="|user=ERROR: User name missing\n";
      		//Write an error in the error element
      		writeTextAndBr(errorElement,"ERROR: User name missing!");
      	}
      	
      	//Close the spoiler parentheses
      	forumOutString+="]\n";
      	
      	//Add name to the inside of the spoiler too
      	forumOutString+="[b]Name:[/b] "+charname+"\n";
      	
      	//Check for gender and age
      	//Get the values
      	var gender = document.getElementById("gender").value;
      	var age = document.getElementById("age").value; 
      	//If the gender is not empty
      	if(/\S/.test(gender)) {
      		forumOutString+="[b]Gender:[/b] "+gender+"\n";
      		wikiOutString+="|gender="+gender+"\n";
      	}
      	//If the age is not empty
      	if(/\S/.test(age)) {
      		forumOutString+="[b]Age:[/b] "+age+"\n";
      		wikiOutString+="|age="+age+"\n";
      	}
      	
      	//Profession and role left blank for now
      	
      	//First mission is set to None and number of missions participated is set to 0
      	wikiOutString+="|firstmission="+"None"+"\n";
      	wikiOutString+="|missionsparticipated="+"0"+"\n";

      	//Check if reason assigned to HMRC is small. If yes, put it in the PC template. Else put it in the page.
      	var reason = document.getElementById("reason").value;
      	if(/\S/.test(reason) && reason.length<=reasonLength) {
      		wikiOutString+="|reasonassingedtohmrc="+reason+"\n";
      	}
      	
      	//Add reason type to the template
      	var reasonType = document.getElementById("reasonType").value;
      	wikiOutString+="|reasontype="+reasonType+"\n";
      	
      	//Close the template tag
      	wikiOutString+="}}\n";
      	
      	//Add wiki headers
      	wikiOutString+="\n==Appearance==\n";
      	wikiOutString+="\n===At Character Creation===\n";
      	
      	//Check for description 
      	var description = document.getElementById("description").value;
      	if(/\S/.test(description)) {
      		forumOutString+="[b]Physical Description:[/b] "+description+"\n";
      		wikiOutString+=description+"\n";
      	} else { //If no physical description was given
      		wikiOutString+="No physical description given.\n";
      	}
      	
      	//Add extra wiki headers
      	wikiOutString+="\n===Current, Out of Armor===\n"
      	wikiOutString+="Same as above.\n";
      	wikiOutString+="\n===In Armor===\n";
      	wikiOutString+="Same as above, in a standard [[MCP-I]].\n";
      	wikiOutString+="\n==Personal Information==\n";
      	
      	//Check for bio
      	var bio = document.getElementById("bio").value;
      	if(/\S/.test(bio)) {
      		forumOutString+="[b]Personal Information:[/b] "+bio+"\n";
      		wikiOutString+=bio+"\n";
      	} else {//If no personal information has been given
      		wikiOutString+="No personal information given.\n";
      	}
      	
      	//Also add reason assigned to bio if it is large enough.
      	if(/\S/.test(reason) && reason.length>reasonLength) {
      		switch(reasonType) {
      			case "hmrc":
      				wikiOutString+="\n===Reason Assigned to HMRC===\n";
	      		break;
	      		case "arm":
      				wikiOutString+="\n===Reason for joining ARM===\n";
      			break;
      			default:
      				wikiOutString+="ERROR: Unknown reason type "+reasonType;
      				writeTextAndBr(errorElement,"ERROR: Unknown reason type "+reasonType);
      			break;
      		}
      		wikiOutString+=reason+"\n";
      	}
      	
      	//And add reason to forum text if it exists
      	if(/\S/.test(reason)) {
      		switch(reasonType) {
      			case "hmrc":
      				forumOutString+="[b]Reason assigned to HMRC:[/b] "+reason+"\n";
	      		break;
	      		case "arm":
      				forumOutString+="[b]Reason for joining ARM:[/b] "+reason+"\n";
      			break;
      			default:
      				forumOutString+="ERROR: Unknown reason type "+reasonType+"\n";
      				writeTextAndBr(errorElement,"ERROR: Unknown reason type "+reasonType);
      			break;
      		}
      	}
      	
      	//Open Stats template
      	wikiOutString+="\n==Attributes==\n";
	wikiOutString+="<section begin=sns />\n";
	wikiOutString+="{{NStats\n";
      	
      	var posLvlTotal;
      	var negLvlTotal;
      	var bonusPlus;
      	//Check stats
      	forumOutString+="\n[b]Stats:[/b] \n";
      	posLvlTotal=0;
      	negLvlTotal=0;
      	bonusPlus=false;
      	for(var selStat=0 ; selStat < stats.length ; selStat++) {
      		var statCode = stats[selStat];
      		//Get the name of the stat
      		var statName = document.getElementById(statCode+"N").textContent.trim();
      		//Get the level of the stat
      		var statLevelText = document.getElementById(statCode+"I").value;
      		var statLevel = parseInt(statLevelText,10);
      		//Add the level to the total and select the rating to change to
      		var newRating;
      		if (statLevel>0) {
      			//If we already have positive points but we have not yet applied the bonus
      			//that reduces the price of the second +1 on another stat
      			if(!bonusPlus && posLvlTotal>0) {
      				//Reduce the price of the second +1 on another stat
      				posLvlTotal-=1;
      				//and mark the bonus as given
      				bonusPlus = true;
      			}
      			posLvlTotal+=statLevel;
      			//Check for over limit
      			if(statLevel>2) {
      				writeTextAndBr(errorElement,"ERROR: Invalid input for stat '"+statName+"': Stats can't have an initial level greater than 2");
      				newRating='wrong';
      			} else {
      				newRating='highRating';
      			}
      		} else if (statLevel<0) {
      			newRating='lowRating';
      			negLvlTotal+=statLevel;
      			//Check for under limit
      			if(statLevel<-2) {
      				writeTextAndBr(errorElement,"ERROR: Invalid input for stat '"+statName+"': Stats can't have an initial level less than 2");
      				newRating='wrong';
      			} else {
      				newRating='lowRating';
      			}
      		} else if (statLevel==0) {
      			newRating='mediumRating';
      		} else if(isNaN(statLevel)) {	
      			newRating='wrong';
      			//Write error and put NaNs everywhere
      			posLvlTotal=NaN;
      			negLvlTotal=NaN;
      			writeTextAndBr(errorElement,"ERROR: Invalid input '"+statLevelText+"' for stat '"+statName+"'");
      		} 
      		//Change rating
      		var TableRowElements = document.getElementsByClassName(statCode+"TR");
		if( TableRowElements.length > 0 && !hasClass(TableRowElements[0],newRating) ) {
			//Find the old rating class
			var oldRating;
			if(hasClass(TableRowElements[0],'mediumRating')) {
				oldRating='mediumRating';
			} else if (hasClass(TableRowElements[0],'highRating')) {
				oldRating='highRating';
			} else if (hasClass(TableRowElements[0],'lowRating')) {
				oldRating='lowRating';
			} else if (hasClass(TableRowElements[0],'wrong')) {
				oldRating='wrong';
			}
			
			//For each memeber of the class
			for(var curTRElem = 0 ; curTRElem < TableRowElements.length ; curTRElem++) {
				//Replace old rating class with new one
				replaceClass(TableRowElements[curTRElem],oldRating, newRating);
			}
		}
      		
      		//Change name of rank and title of rank
      		//First find them
		var levelTitle;
		var levelName;
		switch(statLevel){
		    case -2:
		    	levelName="Disaster";
		    	levelTitle="-2: Disaster: This character is so bad with this skill that it's like they have some sort of curse. 1 is basically an automatic death, maybe permanently. 6 will kill people around you. Anything other then a 5 will fail to some degree, and even 5's will usually have you complete the action in an unorthodox and perhaps not great manner.";
		    break;
		    case -1:
		    	levelName="Hazard";
		    	levelTitle="-1: Hazard: This is one level below Complete Novice. This is someone who thinks they know what they're doing, but is actually dangerously, often fatally, mistaken. 1's will be reality bending disastrous, 6's will be monkey's paws in which the thing gets done, but I as the GM take near fetishistic pleasure in twisting your desires toward some horrible end. Other rolls will generally be varying levels of failure and minor success, with 5's being succeeding through dumb luck.";
		    break;
		    case 0:
		    	levelName="Novice";
		    	levelTitle="+0: Complete Novice: This is someone who has no idea what they're doing, but at least they realize they have no idea what they're doing. They can only guess their way through things, but their unbiased ignorance will cause less problems.";
		    break;
		    case 1:
		    	levelName="Experienced";
		    	levelTitle="+1: Experienced: This is someone who has some knowledge of what they're doing. They're not an expert or anything, but they know the ins and outs of standard actions and can get by fairly well in normal circumstances. Most people could be considered “Experienced” when it comes to driving a car: They probably know a bit about how it works, and can operate it effectively under normal conditions basically without fail. This is when rolls start getting a bit more situational: Standard un-stressed stuff will still get a roll, but 1's will basically act like 2's and 6's like 5's. In other words un-stressed rolls will usually succeed to some degree. Stressed things will be much the same as a novice's rolls, but with somewhat lessened consequences for 1's and 6's.";
		    break;
		    case 2:
		    	levelName="Professional";
		    	levelTitle="+2: Professional: This is someone who knows what they're doing even in stressful or novel situations. A well trained soldier would usually be considered a professional with their weapon. In unstressful and known situations, professionals will always succeed. Rolls will still be used, they'll just be used to see the level of success. In other cases, unfamiliar circumstances or stressful situations, it will be rolls as usual, but for the most part 1's and 6's won't be considered much more then just straight failures or successes with no consequences. The only time there might be consequences is when extenuating circumstances (Bad equipment, for instance) give a good reason for it.";
		    break;
		    case 3:
		    	levelName="Specialist";
		    	levelTitle="+3: Specialist: Someone who is beyond a professional. Someone who is a specialist is highly trained with whatever they're doing. They're much like the professional, with the same auto succeeds, but they are also simply better at their actions. At this point, every roll except 1 is a success, with 5-6's being better then 4-3-2, but still. At least in most circumstances. Again, it becomes situational; A Con specialist should be able to accurately hit stationary targets very reliably. However, if you throw him onto a moving truck and tell him to snipe a guy moving perpendicular to him on a train car, the success rate starts getting lower. Basically, this is success baring extenuating circumstances";
		    break;
		    default:
		    	if(statLevel<2) {
		    		levelName="Invalid";
		    		levelTitle=statLevel+": INVALID: LEVEL CANNOT BE LOWER THAN TWO";
		    	}
		    	else if (statLevel>=4) {
		    		levelName="Master";
		    		levelTitle="+"+statLevel+": Master: Remember Pai Mei from Kill Bill? Yeah, like that. You basically always roll 5's in the majority of circumstances. Things need to be actively restricting you in order to make failure a chance. Note however that even in this level, in certain situations, rolling a 1 is still bad, since it could mean your action not succeeding as much as you'd like it to. It is not mechanically equivalent to always rolling 5s.";
		    		if(statLevel>4) {
		    			levelTitle+="\n\nNote that having a level greater than 4 does not aid you in any way, except when using functions that somehow deduct levels from you. For example, Limiter Unlock makes the player auto-succeed in a roll for a turn, but at the cost of lowering the rolled stat or skill by 1 level for the rest of the mission. If someone at level 5 used a limiter unlock, they would drop to level 4, thus retaining their former capacity, since the two levels are equivalent.";
		    		}
		    	}
		    	else {
		    		levelName="Impossible";
		    		levelTitle=statLevel+": UNKNOWN/IMPOSSIBLE LEVEL";
		    	}
		    break;
		}
      		//Then change the name and title
      		var rank=document.getElementById(statCode+"R");
      		rank.textContent=levelName;
      		rank.title=levelTitle;
      		
      		//Change points left and title of points left
		//Find points left for next level
		//It is the ([the points needed for the next level]-[the points needed for this level])
		var pointsLeft = (getPDelta(statLevel+1)-getPDelta(statLevel));
		var pointsLeftElement = document.getElementById(statCode+'L');
		pointsLeftElement.textContent = pointsLeft;
		pointsLeftElement.title = "You need "+pointsLeft+" more points ("+(pointsLeft/5)+" missions worth) to reach level "+(statLevel+1);
		
		//Write the wiki output
		wikiOutString+="|P"+statCode+"=0"+"|I"+statCode+"="+statLevel+"\n";
		wikiOutString+="|Enhanced"+statCode+"=0\n";
		
		//Write the forum output
		forumOutString+=statName+": "+statLevel+"\n";
      	}
      	
      	//Check if the initial level balance is fine
      	//Find the negative levels needed for the positive levels given
    	var negativeNeeded=-triSeq(posLvlTotal);
	if(bonusPlus){
		negativeNeeded-= 1;
		posLvlTotal += 1;
	}
	//Write an error message if necessary
	var negativeDelta=negativeNeeded-negLvlTotal;
	if(negativeDelta<0) { //-5-(-3)=-2 more levels needed
		writeTextAndBr(errorElement,"ERROR: You need "+(-negativeDelta)+" more negative stat levels.");
	} else if (negativeDelta>0) { //-5-(-7)=2 more negative levels than necessary
		writeTextAndBr(errorElement,"ERROR: You need "+negativeDelta+" less negative stat levels.");
	}
      	
      	//Close stats and open skills
      	wikiOutString+="}}{{NSkills\n";
      	
      	//Check skills
      	forumOutString+="\n[b]Skills:[/b] \n";
      	posLvlTotal=0;
      	negLvlTotal=0;
      	bonusPlus=false;
      	for(var selStat=0 ; selStat < skills.length ; selStat++) {
      		var statCode = skills[selStat];
      		//Get the name of the skill
      		var statName = document.getElementById(statCode+"N").textContent.trim();
      		//Get the level of the skill
      		var statLevelText = document.getElementById(statCode+"I").value;
      		var statLevel = parseInt(statLevelText,10);
      		//Add the level to the total and select the rating to change to
      		var newRating;
      		if (statLevel>0) {
      			//If we already have positive points but we have not yet applied the bonus
      			//that reduces the price of the second +1 on another stat
      			if(!bonusPlus && posLvlTotal>0) {
      				//Reduce the price of the second +1 on another stat
      				posLvlTotal-=1;
      				//and mark the bonus as given
      				bonusPlus = true;
      			}
      			posLvlTotal+=statLevel;
      			//Check for over limit
      			if(statLevel>2) {
      				writeTextAndBr(errorElement,"ERROR: Invalid input for skill '"+statName+"': Skills can't have an initial level greater than 2");
      				newRating='wrong';
      			} else {
      				newRating='highRating';
      			}
      		} else if (statLevel<0) {
      			newRating='lowRating';
      			negLvlTotal+=statLevel;
      			//Check for under limit
      			if(statLevel<-2) {
      				writeTextAndBr(errorElement,"ERROR: Invalid input for skill '"+statName+"': Skills can't have an initial level less than 2");
      				newRating='wrong';
      			} else {
      				newRating='lowRating';
      			}
      		} else if (statLevel==0) {
      			newRating='mediumRating';
      		} else if(isNaN(statLevel)) {	
      			newRating='wrong';
      			//Write error and put NaNs everywhere
      			posLvlTotal=NaN;
      			negLvlTotal=NaN;
      			writeTextAndBr(errorElement,"ERROR: Invalid input '"+statLevelText+"' for skill '"+statName+"'");
      		}  
      		//Change rating
      		var TableRowElements = document.getElementsByClassName(statCode+"TR");
		if( TableRowElements.length > 0 && !hasClass(TableRowElements[0],newRating) ) {
			//Find the old rating class
			var oldRating;
			if(hasClass(TableRowElements[0],'mediumRating')) {
				oldRating='mediumRating';
			} else if (hasClass(TableRowElements[0],'highRating')) {
				oldRating='highRating';
			} else if (hasClass(TableRowElements[0],'lowRating')) {
				oldRating='lowRating';
			} else if (hasClass(TableRowElements[0],'wrong')) {
				oldRating='wrong';
			}
			
			//For each memeber of the class
			for(var curTRElem = 0 ; curTRElem < TableRowElements.length ; curTRElem++) {
				//Replace old rating class with new one
				replaceClass(TableRowElements[curTRElem],oldRating, newRating);
			}
		}
      		
      		//Change name of rank and title of rank
      		//First find them
		var levelTitle;
		var levelName;
		switch(statLevel){
		    case -2:
		    	levelName="Disaster";
		    	levelTitle="-2: Disaster: This character is so bad with this skill that it's like they have some sort of curse. 1 is basically an automatic death, maybe permanently. 6 will kill people around you. Anything other then a 5 will fail to some degree, and even 5's will usually have you complete the action in an unorthodox and perhaps not great manner.";
		    break;
		    case -1:
		    	levelName="Hazard";
		    	levelTitle="-1: Hazard: This is one level below Complete Novice. This is someone who thinks they know what they're doing, but is actually dangerously, often fatally, mistaken. 1's will be reality bending disastrous, 6's will be monkey's paws in which the thing gets done, but I as the GM take near fetishistic pleasure in twisting your desires toward some horrible end. Other rolls will generally be varying levels of failure and minor success, with 5's being succeeding through dumb luck.";
		    break;
		    case 0:
		    	levelName="Novice";
		    	levelTitle="+0: Complete Novice: This is someone who has no idea what they're doing, but at least they realize they have no idea what they're doing. They can only guess their way through things, but their unbiased ignorance will cause less problems.";
		    break;
		    case 1:
		    	levelName="Experienced";
		    	levelTitle="+1: Experienced: This is someone who has some knowledge of what they're doing. They're not an expert or anything, but they know the ins and outs of standard actions and can get by fairly well in normal circumstances. Most people could be considered “Experienced” when it comes to driving a car: They probably know a bit about how it works, and can operate it effectively under normal conditions basically without fail. This is when rolls start getting a bit more situational: Standard un-stressed stuff will still get a roll, but 1's will basically act like 2's and 6's like 5's. In other words un-stressed rolls will usually succeed to some degree. Stressed things will be much the same as a novice's rolls, but with somewhat lessened consequences for 1's and 6's.";
		    break;
		    case 2:
		    	levelName="Professional";
		    	levelTitle="+2: Professional: This is someone who knows what they're doing even in stressful or novel situations. A well trained soldier would usually be considered a professional with their weapon. In unstressful and known situations, professionals will always succeed. Rolls will still be used, they'll just be used to see the level of success. In other cases, unfamiliar circumstances or stressful situations, it will be rolls as usual, but for the most part 1's and 6's won't be considered much more then just straight failures or successes with no consequences. The only time there might be consequences is when extenuating circumstances (Bad equipment, for instance) give a good reason for it.";
		    break;
		    case 3:
		    	levelName="Specialist";
		    	levelTitle="+3: Specialist: Someone who is beyond a professional. Someone who is a specialist is highly trained with whatever they're doing. They're much like the professional, with the same auto succeeds, but they are also simply better at their actions. At this point, every roll except 1 is a success, with 5-6's being better then 4-3-2, but still. At least in most circumstances. Again, it becomes situational; A Con specialist should be able to accurately hit stationary targets very reliably. However, if you throw him onto a moving truck and tell him to snipe a guy moving perpendicular to him on a train car, the success rate starts getting lower. Basically, this is success baring extenuating circumstances";
		    break;
		    default:
		    	if(statLevel<2) {
		    		levelName="Invalid";
		    		levelTitle=statLevel+": INVALID: LEVEL CANNOT BE LOWER THAN TWO";
		    	}
		    	else if (statLevel>=4) {
		    		levelName="Master";
		    		levelTitle="+"+statLevel+": Master: Remember Pai Mei from Kill Bill? Yeah, like that. You basically always roll 5's in the majority of circumstances. Things need to be actively restricting you in order to make failure a chance. Note however that even in this level, in certain situations, rolling a 1 is still bad, since it could mean your action not succeeding as much as you'd like it to. It is not mechanically equivalent to always rolling 5s.";
		    		if(statLevel>4) {
		    			levelTitle+="\n\nNote that having a level greater than 4 does not aid you in any way, except when using functions that somehow deduct levels from you. For example, Limiter Unlock makes the player auto-succeed in a roll for a turn, but at the cost of lowering the rolled skill or skill by 1 level for the rest of the mission. If someone at level 5 used a limiter unlock, they would drop to level 4, thus retaining their former capacity, since the two levels are equivalent.";
		    		}
		    	}
		    	else {
		    		levelName="Impossible";
		    		levelTitle=statLevel+": UNKNOWN/IMPOSSIBLE LEVEL";
		    	}
		    break;
		}
      		//Then change the name and title
      		var rank=document.getElementById(statCode+"R");
      		rank.textContent=levelName;
      		rank.title=levelTitle;
      		
      		//Change points left and title of points left
		//Find points left for next level
		//It is the ([the points needed for the next level]-[the points needed for this level])
		var pointsLeft = (getPDelta(statLevel+1)-getPDelta(statLevel));
		var pointsLeftElement = document.getElementById(statCode+'L');
		pointsLeftElement.textContent = pointsLeft;
		pointsLeftElement.title = "You need "+pointsLeft+" more points ("+(pointsLeft/5)+" missions worth) to reach level "+(statLevel+1);
		
		//Write the wiki output
		wikiOutString+="|P"+statCode+"=0"+"|I"+statCode+"="+statLevel+"\n";
		wikiOutString+="|Enhanced"+statCode+"=0\n";
		
		//Write the forum output
		forumOutString+=statName+": "+statLevel+"\n";
	}
      	
      	//Close SNS template
      	wikiOutString+="<section end=sns />}}\n";
      	
      	//Check if the initial level balance is fine
      	//Find the negative levels needed for the positive levels given
    	negativeNeeded=-triSeq(posLvlTotal);
	if(bonusPlus){
		negativeNeeded-= 1;
		posLvlTotal += 1;
	}
	//Write an error message if necessary
	negativeDelta=negativeNeeded-negLvlTotal;
	if(negativeDelta<0) { //-5-(-3)=-2 more levels needed
		writeTextAndBr(errorElement,"ERROR: You need "+(-negativeDelta)+" more negative skill levels.");
	} else if (negativeDelta>0) { //-5-(-7)=2 more negative levels than necessary
		writeTextAndBr(errorElement,"ERROR: You need "+negativeDelta+" less negative skill levels.");
	}
      	
      	//Add status section
      	wikiOutString+="<section begin=status />\n";
	wikiOutString+="Status: Normal<section end=status />\n";
	
	//Add inventory section
	wikiOutString+="\n==Inventory==\n";
	wikiOutString+="On Person\n";
	wikiOutString+="<section begin=inv />\n";
	wikiOutString+="'''Armor'''\n";
	wikiOutString+="*[[MCP-I]]<section end=inv />\n";
	wikiOutString+="Locker\n";
	wikiOutString+="*5 Tokens\n";
	
	//Add mission history section. This should be the end of the wiki output string
	wikiOutString+="\n==Mission History==\n";
	wikiOutString+="Last Levelup: Never\n";
      	
      	//Close the spoiler tag. This should be the end of the forum output string
      	forumOutString+="[/spoiler]";
      	
      	//Write the output strings in the two textBoxes
      	//Write forum string
      	document.getElementById('forumOut').value = forumOutString;
      	//Write wiki string
      	document.getElementById('wikiOut').value = wikiOutString;
      }
      
      //Apply the style based on cookie (or apply the default style)
      addLoadEvent(onloadStyleFunction);
      //Run on load to apply styles and write output
      addLoadEvent(processInput);
    </script>
    
    <button id="changeStyleButton" onclick="toggleStyle();">Change Style</button>
    
    <a href="/ERIndex.html" class="navigationLink">Back to Index</a>
    
    <p><small>Note: This page has been tested and working on Firefox 41 with JavaScript enabled. It should display properly on any modern browser, with the possible exception of Internet Explorer.</small></p>
    
    <h1>New Character</h1>
    
    <p>Remember, you can hover over things to gain more info about them and you can click on the bottom right edge of textboxes to resize them.</p> 
    
    <p>For more complete and up-to-date info, check the wiki's <a href="http://einsteinianroulette.wikia.com/wiki/New_Player_Guide" class="navigationLink">New Player Guide</a>.</p>
    
    <form oninput="processInput();">
      <fieldset name="IDInfo">
        <legend>Identification Data (required):</legend>
        <div class="formgroup">
        <div class="formline" title="Your forum name"><span class="formlabel"><label for="username">User Name:</label></span> <span class="formtext"><input required type="text" name="username" id="username" placeholder="Your forum name"></span></div>
        <div class="formline" title="The name of your character"><span class="formlabel"><label for="charname">Character Name:</label></span> <span class="formtext"><input required type="text" name="charname" id="charname" placeholder="The name of your character"></span></div>
        </div>
      </fieldset>
      <fieldset name="detailedInfo">
        <legend>Detailed Personal Information (optional):</legend>
        <div class="formgroup">
        <div class="formline" title="Your character's gender"><span class="formlabel"><label for="gender">Gender:</label></span> <span class="formtext"><input type="text" name="gender" id="gender" placeholder="Your character's gender"></span></div>
        <div class="formline" title="Your character's age. Try to not make it absurd. Children may not be accepted."><span class="formlabel"><label for="age">Age:</label></span> <span class="formtext"><input type="text" name="age" id="age" placeholder="Your character's age. Try to not make it absurd. Children may not be accepted."></span></div>
        <div class="formline" title="What your character looks like"><span class="formlabel"><label for="description">Physical Description:</label></span> <span class="formtext"><textarea name="description" id="description" placeholder="What your character looks like"></textarea></span></div>
        <div class="formline" title="Info you deem important about your character's life and personality"><span class="formlabel"><label for="bio">Personal Information:</label></span> <span class="formtext"><textarea name="bio" id="bio" placeholder="Info you deem important about your character's life and personality"></textarea></span></div>
        <div class="formline" title="The reason you ended up with the HMRC prisoner unit or decided to join ARM's revolution against the UWM. Note that if you were sent to the HMRC, then that happened about 200-400 years ago in objective time, while if you decided to join ARM then it should had happened in the few years that the rebellion has been active. If your history does not agree with in-game lore, then that will be attributed to stasis dementia, brain damage caused by flaws in the stasis pods.">
        	<span class="formlabel"><select name="reasonType" id="reasonType">
        		<option selected value="hmrc">Reason assigned to HMRC</option>
        		<option value arm="arm">Reason for joining ARM</option>
        	</select></span>
        	<span class="formtext"><textarea name="reason" id="reason" placeholder="The reason you ended up with the HMRC prisoner unit or decided to join ARM's revolution against the UWM. Note that if you were sent to the HMRC, then that happened about 200-400 years ago in objective time, while if you decided to join ARM then it should had happened in the few years that the rebellion has been active. If your history does not agree with in-game lore, then that will be attributed to stasis dementia, brain damage caused by flaws in the stasis pods."></textarea></span>
        </div>
        </div>
      </fieldset>
      <fieldset name="statsandskills">
        <legend>Starting stat and skill levels:</legend>
        <table id="mainTable">
          <tr>
              <th colspan="4" class="tableTitle" title="Also known as your physical attributes, these are mostly innate things, somehow connected with your body and mind."><h2>Stats</h2></th>
            <td class="separator">&nbsp;</td>
              <th colspan="4" class="tableTitle" title="Also known as your mental attributes, these are mostly mental things, things your character has consciously learned during his life."><h2>Skills</h2></th>
          </tr>
          <tr class="colTitle">
              <th title="The name of the Stat. Hover over it for more info">
                Name</th>
              <th colspan="2" title="The level of the Stat during character creation. Hover over its name for more info">
                Level</th>
              <th title="How many more points you must put to that Skill to reach the next level">
                Left for next level</th>
            <td class="separator">&nbsp;</td>
              <th title="The name of the Skill. Hover over it for more info">
                Name</th>
              <th colspan="2" title="The level of the Skill during character creation. Hover over its name for more info">
                Level</th>
              <th title="How many more points you must put to that Skill to reach the next level">
                Left for next level</th>
          </tr>
          <tr>
              <th class="StrTR mediumRating" id="StrN" title="How good you are at lifting heavy things and then putting them down. Useful for wielding certain weapons. 
  		
  Useful in hand to hand combat, for throwing things and for lifting things (including some weapons or weapons you'd normally be unable to lift). Note that this stat doesn't describe your actual amount of strength; Instead it controls how well you control what strength you have. A giant robot with -2 strength will accidentally crush things it meant to lightly tap, and lightly tap things which it mean to crush.
  This stat is required to wield some weapons (most notably gauss rifles) and heavy equipment. This stat is rolled for hand to hand combat, melee weapons that don't use unconventional and other similar things.">
                Strength</th>
              <td class="StrTR mediumRating"><input type="number" id="StrI" value="0" min="-2" max="2"></td>
              <td class="StrTR mediumRating"><output id="StrR">Novice</output></td>
              <td class="StrTR mediumRating"><output id="StrL">5</output></td>
            <td class="separator">&nbsp;</td>
              <th class="HandTR mediumRating" id="HandN" title="Making things, breaking things, and otherwise turning stuff from X into laser-guided, thermonuclear Y.
		
People with a high level of this skill can construct almost anything provided they have the right parts. Very useful if you are going to be working with tinker and custom equipment in general and don't want to pay someone else to construct your prototypes. Also very useful in those situations when you are trapped somewhere with limited resources and need to construct something to survive and/or escape and generally building your own spare parts. Overshoots may cause you to weld yourself to what you are building or cause it to explode prematurely or overload.">
                Handiwork</th>
              <td class="HandTR mediumRating"><input type="number" id="HandI" value="0" min="-2" max="2"></td>
              <td class="HandTR mediumRating"><output id="HandR">Novice</output></td>
              <td class="HandTR mediumRating"><output id="HandL">5</output></td>
          </tr>
          <tr> 
          	<th class="DexTR mediumRating" id="DexN" title="Not tripping over your big stupid feet.
		
Useful in hand to hand combat, acting quickly, running, dodging and generally doing things that require speed, accuracy and coordination. Its usefulness in dodging makes this stat a must have for all characters.
This stat is required to wield some melee weapons (most notably, Monoatomic Razors).
This stat is rolled for for hand to hand combat, melee weapons that don't use unconventional and other similar things ">
          		Dexterity</th>
          	<td class="DexTR mediumRating"><input type="number" id="DexI" value="0" min="-2" max="2"></td>
          	<td class="DexTR mediumRating"><output id="DexR">Novice</output></td>
          	<td class="DexTR mediumRating"><output id="DexL">5</output></td>
              <td class="separator">&nbsp;</td>
              	<th class="ConTR mediumRating" id="ConN" title="By conventional weapons we mean anything that follows the general concept of &quot;A metal tube which you point at things and a potentially lethal something shoot out&quot;. 

This is used for firing weapons that look like guns. That means weapons that have an end that you point to things that you want to stop existing and some kind of trigger. Overshoots tend to destroy your target with some bad side effects (for example, overkill, wasting ammo, friendly fire or structural damage) while critfails may cause you to shoot yourself.">
			Conventional</th>
		<td class="ConTR mediumRating"><input type="number" id="ConI" value="0" min="-2" max="2"></td>
          	<td class="ConTR mediumRating"><output id="ConR">Novice</output></td>
          	<td class="ConTR mediumRating"><output id="ConL">5</output></td>
          </tr>
          <tr>
          	<th class="EndTR mediumRating" id="EndN" title="Being able to run more then 10 feet before your heart explodes and not passing out from a paper cut.

Useful for surviving damage and enduring effects such as poison, over-medication, drunkenness and tiredness. This stat is also used for surviving lethal area of effect damage like explosions and massive amounts of gunfire. Some times the weapon that hit you might be so powerful (or your failure so great) that endurance will do nothing more than dictate whether or not your brain will remain intact enough to be revived.">
			Endurance</th>
          	<td class="EndTR mediumRating"><input type="number" id="EndI" value="0" min="-2" max="2"></td>
          	<td class="EndTR mediumRating"><output id="EndR">Novice</output></td>
          	<td class="EndTR mediumRating"><output id="EndL">5</output></td>	
              <td class="separator">&nbsp;</td>
              	<th class="UnconTR mediumRating" id="UnconN" title="Covers your non-death-tube armaments. Explosives, hand to hand weapons, field manipulators, etc.

This is used for melee weapons sold in the armoury, most explosives and for manipulators (&quot;magic&quot; calculators that can break physics). Also used for ranged weapons that don't belong in the other weapon categories (Conventional,Exotic,Auxiliary). Overshoots and critfails tend to have effects similar with those that happen with conventional weapons. Special mention should be made to manipulator critfails, since they can have very nasty effects (like making your blood boil or causing the manipulator to explode like a grenade). ">
			Unconventional</th>
          	<td class="UnconTR mediumRating"><input type="number" id="UnconI" value="0" min="-2" max="2"></td>
          	<td class="UnconTR mediumRating"><output id="UnconR">Novice</output></td>
          	<td class="UnconTR mediumRating"><output id="UnconL">5</output></td>
          </tr>
          <tr>
          	<th class="ChaTR mediumRating" id="ChaN" title="Are you a cool dude? A handy skill for when you want to talk a bullet out of embedding itself in your faceplate. Handles all aspects of interpersonal communications. Probably not used very much.

Can be used to look cool, beautiful and generally make a good impression on people or conversely infiltrate locations and move amongst them unnoticed, hiding in plain sight. People with low level of skill can use it to terrorize civilians, cause misunderstandings and speak in the most hilarious of ways. People who are competent with speech however should be able to fool enemies, persuade civilians to do things, make inspiring speeches and increase the effectiveness of their mind control amps.
This stat is required to use the mind control kind of Psychokinetic Amplifiers. It can also be useful when combined with equipment like the Black Halo.">
			Charisma</th>
          	<td class="ChaTR mediumRating"><input type="number" id="ChaI" value="0" min="-2" max="2"></td>
          	<td class="ChaTR mediumRating"><output id="ChaR">Novice</output></td>
          	<td class="ChaTR mediumRating"><output id="ChaL">5</output></td>
              <td class="separator">&nbsp;</td>
          	<th class="ExoTR mediumRating" id="ExoN" title="Things which blur the line between weapon, augment and supernatural force. Includes various psychokinetic amps, implants, genetic augmentation and most alien weaponry.

This is used for using alien stuff or otherwise weird weapons that don't look like conventional weapons. Also used for Psychokinetic Amplifiers (&quot;magic&quot; brain implants that can break physics). Overshoots and critfails tend to have effects similar with those of Unconventional weapons, with the added danger that some of those may mess with your body or mind in &quot;supernatural&quot; ways.">
			Exotic</th>
          	<td class="ExoTR mediumRating"><input type="number" id="ExoI" value="0" min="-2" max="2"></td>
          	<td class="ExoTR mediumRating"><output id="ExoR">Novice</output></td>
          	<td class="ExoTR mediumRating"><output id="ExoL">5</output></td>
          </tr>
          <tr>
          	<th class="MindTR mediumRating" id="MindN" title="Bending spoons and (usually) not losing your mind. Also helps you not be a god damn idiot (sometimes).

Useful for resisting alien influences and the usage of space magic like amps and manipulators on you. Also useful for gaining data by analysing a situation and finding useful intel on the internet.
This stat also gives you mind points that are used up when using amps to do something hard, resisting mindfuck or otherwise straining your mind (usually while doing something supernatural).">
			Mind</th>
          	<td class="MindTR mediumRating"><input type="number" id="MindI" value="0" min="-2" max="2"></td>
          	<td class="MindTR mediumRating"><output id="MindR">Novice</output></td>
          	<td class="MindTR mediumRating"><output id="MindL">5</output></td>
              <td class="separator">&nbsp;</td>
          	<th class="AuxTR mediumRating" id="AuxN" title="The operation of things that are not purely weapons, or of weapons that are part of large systems. Includes mecha, exosuits, space ships and other vehicles, as well as computer controlled weapons, drones and etc. 

This is used for using, maintaining and repairing machines. Includes things such as piloting shuttles or jetpacks, hacking computers, bypassing doors, using computer-targeted weapons, ordering robotic attack drones around, etc. Also very useful for helping your robotic or exosuit-wearing teammates. Can also be useful when you're trying to use tools like welders as weapons. Overshoots and critfails may leave you welded on your robotic teammates or piloting your shuttle into a building or through the closed hangar doors.">
			Auxiliary</th>
          	<td class="AuxTR mediumRating"><input type="number" id="AuxI" value="0" min="-2" max="2"></td>
          	<td class="AuxTR mediumRating"><output id="AuxR">Novice</output></td>
          	<td class="AuxTR mediumRating"><output id="AuxL">5</output></td>
          </tr>
          <tr>
          	<th class="FateTR mediumRating" id="FateN" title="Do you feel lucky, punk?
		
It's fate. We don't really have anything more to say about this, as Piecewise is being intentionally cagey about it. Our working assumption is that it governs semi-random events, such as who gets hit by AA lasers during a drop, how badly things go wrong, and how interactions with the Gods go.">
          		Fate</th>
          	<td class="FateTR mediumRating"><input type="number" id="FateI" value="0" min="-2" max="2"></td>
          	<td class="FateTR mediumRating"><output id="FateR">Novice</output></td>
          	<td class="FateTR mediumRating"><output id="FateL">5</output></td>
              <td class="separator">&nbsp;</td>
          	<th class="MedTR mediumRating" id="MedN" title="A mechanic both for people and the systems that keep people from dying in various ways. 

Used for being a good medic and helping your teammates. Can also be used to identify what's wrong with a teammate. Overshoots and critfails may leave you over-medicating your teammates, identifying their ailments as &quot;space worms in the brain&quot; or trying to cure said ailments via kicking.">
			Medical</th>
          	<td class="MedTR mediumRating"><input type="number" id="MedI" value="0" min="-2" max="2"></td>
          	<td class="MedTR mediumRating"><output id="MedR">Novice</output></td>
          	<td class="MedTR mediumRating"><output id="MedL">5</output></td>
          </tr>
          <tr>
          	<th class="IntuTR mediumRating" id="IntuN" title="That sixth sense, that tingly feeling in the back of your neck that lets you know that the meatloaf is bad or that someone's just lobbed a microton grenade into your latrine. Helpful for guessing your way through defusing a H-bomb or finding your way back to your bunk after a half dozen to many drinks.

Your gut feeling. Are your guts feeling well? No? Time to dive into trench because something bad is about to happen.
People with a high level of this stat might be able to sense ambushes or teammates trying to cause them harm (intentionally or unintentionally), guess the position of snipers or mines, sense the evil intentions of alien artefacts and generally pull information out of nowhere. However, information provided by this stat tend to be a bit more vague and untrustworthy then information provided by the Mind stat.">
			Intuition</th>
          	<td class="IntuTR mediumRating"><input type="number" id="IntuI" value="0" min="-2" max="2"></td>
          	<td class="IntuTR mediumRating"><output id="IntuR">Novice</output></td>
          	<td class="IntuTR mediumRating"><output id="IntuL">5</output></td>
              <td class="separator">&nbsp;</td>
          	<th class="GenTR mediumRating" id="GenN" title="You know about the thing at the place? Yeah, of course you do.

Used for figuring out how much you know about the world, in character. Note that this also includes doing things, as well as knowing things. Do you want to play the banjo? General Knowledge roll. Do you want to judge the quality of that cheese? General Knowledge roll. Do you want to know what piece of equipment your enemy is using that is making him immune to your attacks? General Knowledge roll. Generally, it's the skill you roll when no other skill fits what you are trying to do.">
			Gen. Knowledge</th>
          	<td class="GenTR mediumRating"><input type="number" id="GenI" value="0" min="-2" max="2"></td>
          	<td class="GenTR mediumRating"><output id="GenR">Novice</output></td>
          	<td class="GenTR mediumRating"><output id="GenL">5</output></td>
          </tr>
        </table>
      </fieldset>
      <fieldset name="output">
      	<legend>Output:</legend>
      	<div class="formline" title="Any errors will appear here in big red letters">
      		<span>Error: </span> <span class="error" id="formErrors"></span>
      	</div>
      	<div title="This output can be posted on the on ship thread to apply for your character">
	      	<label for="forumOut">Forum Output (to be posted on the <a href="http://www.bay12forums.com/smf/index.php?topic=108083.0" class="navigationLink">On Ship Thread</a>):</label>
	      	<textarea readonly class="outTextBox" name="forumOut" id="forumOut"></textarea>
      	</div>
      	<div title="This output can be optionally posted on the wiki. You can make any alteration to it you desire to make it better match your character (within reason). If you do not add it to the wiki yourself, someone else will do it for you.">
	      	<label for="wikiOut">Wiki Output (to be added to the <a href="http://einsteinianroulette.wikia.com/wiki/Einsteinian_Roulette_Wiki" class="navigationLink">Einsteinian Roulette Wiki</a> <s>in triplicate</s>):</label>
	      	<textarea readonly class="outTextBox" name="wikiOut" id="wikiOut"></textarea>
	      	<div class="warning">Note: It is not necessary to add the character to the wiki yourself. If you do not, someone else will do it for you.</div>
	</div>
      </fieldset>
    </form>
    
  </body>
</html>
